TODO:
* Cleanup sources and refactor
* Better mingw32 support
* Better error handling

